<!doctype html>
<html>
  <head>
    <link href="calculator.css" rel="stylesheet" />
    <script>
      function calculator(form) {
        const e = Number(form.e.value);
        const f = Number(form.f.value);
        const j = Number(form.j.value);
        const h = ((e * 1000) / (4200 * (f - j))) * 3600;
        form.total.value = h.toFixed(0);
      }

      // add/remove .has-value on inputs so they turn yellow when non-empty
      document.addEventListener("DOMContentLoaded", function () {
        const form = document.querySelector("form.calculator");
        if (!form) return;
        const inputs = form.querySelectorAll('input[type="text"]');

        function toggleHasValue(el) {
          if (el.value && el.value.trim() !== "") el.classList.add("has-value");
          else el.classList.remove("has-value");
        }

        inputs.forEach((input) => {
          // initial state
          toggleHasValue(input);
          // update on user input
          input.addEventListener("input", () => toggleHasValue(input));
        });

        // clear highlights on form reset
        const resetBtn = form.querySelector('input[type="reset"]');
        if (resetBtn) {
          resetBtn.addEventListener("click", () => {
            inputs.forEach((i) => i.classList.remove("has-value"));
          });
        }
      });
    </script>
  </head>

  <body>
    <!-- Калькулятор (начало) -->
    <form class="calculator">
      <label>
        <span style="margin-left: 13px">Мощность водяного калорифера, кВт</span>
        <input
          type="text"
          name="e"
          onchange="this.value=this.value.replace(/([^0-9.])/g,'');"
          onkeyup="var n=this.value.replace(/([^0-9.])/g,''); if(n!=this.value) this.value=n;"
        />
      </label>

      <label>
        Температура теплоносителя на входе, °С
        <input
          type="text"
          name="f"
          onkeyup="this.value=this.value.replace(/([^-0-9])/g,'');"
        />
      </label>

      <label>
        Температура теплоносителя на выходе, °С
        <input
          type="text"
          name="j"
          onkeyup="this.value=this.value.replace(/([^-0-9])/g,'');"
        />
      </label>

      <div class="calculator-buttons">
        <input
          type="button"
          value="Рассчитать"
          onclick="calculator(this.form)"
        />
        <input type="reset" value="Сброс" />
      </div>

      <label>
        Расход теплоносителя, кг/час
        <input type="text" name="total" disabled class="bg-transparent" />
      </label>
    </form>
    <!-- Калькулятор (конец) -->
  </body>
</html>
